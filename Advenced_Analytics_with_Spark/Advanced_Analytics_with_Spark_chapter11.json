{"paragraphs":[{"title":"Analyzing Neuroimaging Data with PySpark and Thunder","text":"// Thunder is a Python toolfor processing large amounts of spatial/temporal data sets\n// loding data with Thunder\n\nimport thunder as td\ndata = td.images.fromtif('/user/ds/neuro/fish', engine=sc) // thunder also supports local operations with the same API, but here we use engine to pass the SparkContext object\nprint data\nprint type(data.values)\nprint data.values._rdd\n\nprint data.shape\n\n// visualize a single slice of brain image data\nimport matplotlib.pyplot as plt\nimg = data.first()\nplt.imshow(img[:,:,0], interpolation='nearest', aspect='equal',cmap='gray')\n//subsampled image data\nsubsampled = data.subsample((1,5,5)) // the first dimension is not subsampled, but the second and third dimensions take every fifth value\nplt.imshow(subsampled.first()[:,:,0], interpolation='nearest', aspect='equal', cmap='gray')\n\nseries = data.toseries()\nprint series.shape\nprint series.index\nprint series.count()\n\nprint series.max().values","user":"anonymous","dateUpdated":"2018-06-07T14:26:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1528375865835_-835604268","id":"20180607-125105_1959954570","dateCreated":"2018-06-07T12:51:05+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8167"},{"title":"categorizing neuron types with Thunder","text":"images = td.images.frombinary('/user/ds/neuro/fish-long', order='F', engine=sc)\nseries = images.toseries()\nprint series.shape\n\nnormalized = series.normalize(method='mean')\nstddevs = (normalized.map(lamba s: s.std())).sample(1000)\nplt.hist(stddevs.values, bins=20)\nplt.plot(normalized.filter(lamba s: std() >= 0.1).sample(50).values.T)\n\n","user":"anonymous","dateUpdated":"2018-06-07T14:46:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1528370474342_-1750678515","id":"20180607-112114_515291554","dateCreated":"2018-06-07T11:21:14+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8168"}],"name":"/EE_YU/Advanced_Analytics_with_Spark/chapter11","id":"2DGRUR6ES","angularObjects":{"2CDBRM16S:shared_process":[],"2CGD9PJEV:shared_process":[],"2CEXJP4VC:shared_process":[],"2CEWFDUFC:shared_process":[],"2CCUD92DR:shared_process":[],"2CE5CMKN8:shared_process":[],"2CCT6VFHB:shared_process":[],"2CGDHC2BR:shared_process":[],"2CD5H5KA3:shared_process":[],"2CCFV6EWC:shared_process":[],"2CG8AUTUC:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}